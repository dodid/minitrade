
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Official Documentation for Minitrade - Simplifying Personal Trading">
      
      
      
      
        <link rel="prev" href="../contributing/">
      
      
        <link rel="next" href="../api_datasource/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>minitrade.backtest - Minitrade</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-HK9C9K1N4Q"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-HK9C9K1N4Q",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-HK9C9K1N4Q",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#minitradebacktest" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Minitrade" class="md-header__button md-logo" aria-label="Minitrade" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Minitrade
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              minitrade.backtest
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/dodid/minitrade" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    dodid/minitrade
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Minitrade" class="md-nav__button md-logo" aria-label="Minitrade" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Minitrade
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dodid/minitrade" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    dodid/minitrade
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backtesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtesting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trading
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Line
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    minitrade.backtest
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    minitrade.backtest
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;backtesting
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" backtesting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Allocation
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Allocation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.bucket" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bucket
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.modified" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;modified
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.previous_weights" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;previous_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.tickers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tickers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.unallocated" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unallocated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.weights" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Bucket
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Bucket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.tickers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tickers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weights" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.append" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;append
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.apply" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;apply
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.remove" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;remove
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.trim" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;trim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_equally" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;weight_equally
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_explicitly" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;weight_explicitly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_proportionally" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;weight_proportionally
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.assume_previous" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;assume_previous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.assume_zero" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;assume_zero
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.normalize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;normalize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Backtest" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Backtest
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Backtest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Backtest.optimize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;optimize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Backtest.plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Backtest.run" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Order
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Order">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.entry_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;entry_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.is_contingent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_contingent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.is_long" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_long
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.is_short" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_short
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.limit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;limit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.size" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.sl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.stop" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;stop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.tag" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.tp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.cancel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cancel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Position
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Position">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.is_long" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_long
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.is_short" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_short
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.pl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.pl_pct" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pl_pct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.size" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.close" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Strategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.alloc" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alloc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.closed_trades" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;closed_trades
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.equity" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;equity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.orders" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;orders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.storage" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.I" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;I
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.buy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;buy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.init" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;init
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.next" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;next
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.position" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;position
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.prepare_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;prepare_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.rebalance" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rebalance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.record" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.sell" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.start_on_day" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_on_day
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.trades" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;trades
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Trade
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Trade">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.entry_bar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;entry_bar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.entry_price" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;entry_price
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.entry_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;entry_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.exit_bar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;exit_bar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.exit_price" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;exit_price
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.exit_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;exit_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.is_long" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_long
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.is_short" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_short
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.pl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.pl_pct" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pl_pct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.size" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.sl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.tag" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.tp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.value" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.close" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_datasource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    minitrade.datasource
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_broker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    minitrade.broker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;backtesting
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" backtesting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Allocation
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Allocation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.bucket" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bucket
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.modified" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;modified
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.previous_weights" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;previous_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.tickers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tickers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.unallocated" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unallocated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.weights" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Bucket
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Bucket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.tickers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tickers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weights" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.append" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;append
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.apply" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;apply
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.remove" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;remove
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.trim" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;trim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_equally" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;weight_equally
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_explicitly" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;weight_explicitly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_proportionally" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;weight_proportionally
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.assume_previous" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;assume_previous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.assume_zero" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;assume_zero
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Allocation.normalize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;normalize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Backtest" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Backtest
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Backtest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Backtest.optimize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;optimize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Backtest.plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Backtest.run" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Order
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Order">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.entry_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;entry_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.is_contingent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_contingent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.is_long" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_long
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.is_short" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_short
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.limit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;limit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.size" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.sl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.stop" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;stop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.tag" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.tp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Order.cancel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cancel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Position
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Position">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.is_long" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_long
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.is_short" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_short
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.pl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.pl_pct" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pl_pct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.size" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Position.close" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Strategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.alloc" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alloc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.closed_trades" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;closed_trades
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.equity" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;equity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.orders" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;orders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.storage" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.I" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;I
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.buy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;buy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.init" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;init
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.next" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;next
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.position" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;position
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.prepare_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;prepare_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.rebalance" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rebalance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.record" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.sell" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.start_on_day" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_on_day
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Strategy.trades" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;trades
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Trade
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Trade">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.entry_bar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;entry_bar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.entry_price" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;entry_price
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.entry_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;entry_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.exit_bar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;exit_bar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.exit_price" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;exit_price
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.exit_time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;exit_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.is_long" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_long
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.is_short" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_short
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.pl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.pl_pct" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;pl_pct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.size" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.sl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.tag" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.tp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.value" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minitrade.backtest.core.backtesting.Trade.close" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="minitradebacktest">minitrade.backtest<a class="headerlink" href="#minitradebacktest" title="Permanent link">¤</a></h1>


<div class="doc doc-object doc-module">



<h2 id="minitrade.backtest.core.backtesting" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">minitrade.backtest.core.backtesting</span>


<a href="#minitrade.backtest.core.backtesting" class="headerlink" title="Permanent link">¤</a></h2>

    <div class="doc doc-contents first">

        <p>Core framework data structures.
Objects from this module can also be imported from the top-level
module directly, e.g.</p>
<div class="language-text highlight"><pre><span></span><code>from minitrade.backtest import Backtest, Strategy
</code></pre></div>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="minitrade.backtest.core.backtesting.Allocation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Allocation</span>


<a href="#minitrade.backtest.core.backtesting.Allocation" class="headerlink" title="Permanent link">¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Allocation</span><span class="p">(</span><span class="n">tickers</span><span class="p">:</span> <span class="n">list</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>The <code class="language-python highlight"><span class="n">Allocation</span></code> class manages the allocation of values among different assets in a portfolio. It provides 
methods for creating and managing asset buckets, assigning weights to assets, and merging the weights into the 
parent allocation object.</p>
<p><code class="language-python highlight"><span class="n">Allocation</span></code> is not meant to be instantiated directly. Instead, it is created automatically when a new
<code class="language-python highlight"><span class="n">Strategy</span></code> object is created. The <code class="language-python highlight"><span class="n">Allocation</span></code> object is accessed through the <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">alloc</span></code> property.</p>
<p>The <code class="language-python highlight"><span class="n">Allocation</span></code> object is used as an input to the <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">rebalance</span><span class="p">()</span></code> method to rebalance the portfolio according
to the current weight allocation.</p>
<p><code class="language-python highlight"><span class="n">Allocation</span></code> has the following notable properties:</p>
<ul>
<li><code class="language-python highlight"><span class="n">tickers</span></code>: A list of tickers representing the asset space in the allocation.</li>
<li><code class="language-python highlight"><span class="n">weights</span></code>: The weight allocation to be used in the current rebalance cycle.</li>
<li><code class="language-python highlight"><span class="n">previous_weights</span></code>: The weight allocation used in the previous rebalance cycle.</li>
<li><code class="language-python highlight"><span class="n">unallocated</span></code>: Unallocated equity weight, i.e. 1 minus the sum of weights already allocated to assets.</li>
<li><code class="language-python highlight"><span class="n">bucket</span></code>: Bucket accessor for weight allocation.</li>
</ul>
<p><code class="language-python highlight"><span class="n">Allocation</span></code> provides two ways to assign weights to assets:</p>
<ol>
<li>
<p>Explicitly assign weights to assets using <code class="language-python highlight"><span class="n">Allocation</span><span class="o">.</span><span class="n">weights</span></code> property. </p>
<p>It's possible to assign weights to individual asset or to all assets in the asset space as a whole. Not all weights 
need to be specified. If an asset is not assigned a weight, it will have a weight of 0.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Assign weight to individual asset</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">strategy</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Assign weight to all assets</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">strategy</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
</code></pre></div></p>
</li>
<li>
<p>Use <code class="language-python highlight"><span class="n">Bucket</span></code> to assign weights to logical groups of assets, then merge the weights into the parent allocation object.</p>
<p>A <code class="language-python highlight"><span class="n">Bucket</span></code> is a container that groups assets together and provieds methods for weight allocation. Assets can be added
to the bucket by appending lists or filtering conditions. Weights can be assigned to the assets in the bucket using
different allocation methods. Multiple buckets can be created for different groups of assets. Once the weight 
allocation is done at bucket level , the weights of the buckets can be merged into those of the parent allocation object.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Create a bucket and add assets to it</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">bucket</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">bucket</span><span class="p">[</span><span class="s1">&#39;bucket1&#39;</span><span class="p">]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1"># Assign weights to the assets in the bucket</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">bucket</span><span class="o">.</span><span class="n">weight_explicitly</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1"># Merge the bucket into the parent allocation object</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">bucket</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;update&#39;</span><span class="p">)</span>
</code></pre></div></p>
</li>
</ol>
<p>The state of the <code class="language-python highlight"><span class="n">Allocation</span></code> object is managed by the <code class="language-python highlight"><span class="n">Strategy</span></code> object across rebalance cycles. A rebalance
cycle involves:</p>
<ol>
<li>Initializing the weight allocation at the beginning of the cycle by calling either <code class="language-python highlight"><span class="n">Allocation</span><span class="o">.</span><span class="n">assume_zero</span><span class="p">()</span></code> 
to reset all weights to zero or <code class="language-python highlight"><span class="n">Allocation</span><span class="o">.</span><span class="n">assume_previous</span><span class="p">()</span></code> to inherit the weights from the previous cycle. This
must be done before any weight allocation attempts.</li>
<li>Adjusting the weight allocation using either explicitly assignment or <code class="language-python highlight"><span class="n">Bucket</span></code> method.</li>
<li>Calling <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">rebalance</span><span class="p">()</span></code> to rebalance the portfolio according to the current allocation plan.</li>
</ol>
<p>After each rebalance cycle, the weight allocation is reset, and the process starts over. At any point, the weight
allocation from the previous cycle can be accessed using the <code class="language-python highlight"><span class="n">previous_weights</span></code> property. </p>
<p>A rebalance cycle is not necessarily equal to the simulation time step. For example, simulation can be done at 
daily frequency, while the portfolio is rebalanced every month. In this case, the weight allocation is maintained 
across multiple time steps until the next time <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">rebalance</span><span class="p">()</span></code> is called.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">class</span> <span class="nc">MyStrategy</span><span class="p">(</span><span class="n">Strategy</span><span class="p">):</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>        <span class="k">pass</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>        <span class="c1"># Initialize the weight allocation</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">assume_zero</span><span class="p">()</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>        <span class="c1"># Adjust the weight allocation</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">bucket</span><span class="p">[</span><span class="s1">&#39;equity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weight_equally</span><span class="p">(</span><span class="n">sum_</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;update&#39;</span><span class="p">)</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">bucket</span><span class="p">[</span><span class="s1">&#39;bond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weight_equally</span><span class="p">(</span><span class="nb">sum</span><span class="o">=</span><span class="n">_0</span><span class="mf">.4</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;update&#39;</span><span class="p">)</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">unallocated</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>        <span class="c1"># Rebalance the portfolio</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rebalance</span><span class="p">()</span>
</code></pre></div></p>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Allocation.bucket" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bucket</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Allocation.bucket" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">bucket</span><span class="p">:</span> <span class="n"><span title="minitrade.backtest.core.backtesting.Allocation.BucketGroup">BucketGroup</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p><code class="language-python highlight"><span class="n">bucket</span></code> provides access to a dictionary of buckets.</p>
<p>A bucket can be accessed with a string key. If the bucket does not exist, one will be created automatically.</p>
<p>Buckets are cleared after each rebalance cycle.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Access the bucket named &#39;equity&#39;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">bucket</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">bucket</span><span class="p">[</span><span class="s1">&#39;equity&#39;</span><span class="p">]</span>
</code></pre></div></p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Allocation.modified" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">modified</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Allocation.modified" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">modified</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>True if weight allocation is changed from previous values.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Allocation.previous_weights" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">previous_weights</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Allocation.previous_weights" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">previous_weights</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Previous weight allocation. This is a read-only property.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Allocation.tickers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tickers</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Allocation.tickers" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tickers</span><span class="p">:</span> <span class="n">list</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Assets representing the asset space. This is a read-only property</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Allocation.unallocated" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">unallocated</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Allocation.unallocated" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">unallocated</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Unallocated equity weight. It's the remaining weight that can be allocated to assets. This is a read-only property.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Allocation.weights" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">weights</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Allocation.weights" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">weights</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Current weight allocation. Weight should be non-negative and the total weight should be less than or equal to 1.</p>
<p>It's possible to assign weights to individual asset or to all assets in the asset space as a whole. When assigning
weights as a whole, only non-zero weights need to be specified, and other weights are assigned zero automatically.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Assign weight to individual asset</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">strategy</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Assign weight to all assets</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">strategy</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
</code></pre></div></p>
    </div>

</div>


<div class="doc doc-object doc-class">



<h4 id="minitrade.backtest.core.backtesting.Allocation.Bucket" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Bucket</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Bucket</span><span class="p">(</span><span class="n">alloc</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation" href="#minitrade.backtest.core.backtesting.Allocation">Allocation</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p><code class="language-python highlight"><span class="n">Bucket</span></code> is a container that groups assets together and applies weight allocation among them.
A bucket is associated with a parent allocation object, while the allocation object can be
associated with multiple buckets.</p>
<p>Assets in a bucket are identified by their tickers. They are unique within the bucket, but can be
repeated in different buckets. </p>
<p>Using <code class="language-python highlight"><span class="n">Bucket</span></code> for weight allocation takes 3 steps: </p>
<ol>
<li>Assets are added to the bucket by appending lists or filtering conditions. The rank of the assets 
in the bucket is preserved and can be used to assign weights. </li>
<li>Weights are assigned to the assets using different allocation methods. </li>
<li>Once the weight allocation at bucket level is done, the weights of the bucket can be merged into 
those of the parent allocation object.</li>
</ol>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.tickers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tickers</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.tickers" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tickers</span><span class="p">:</span> <span class="n">list</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Assets in the bucket. This is a read-only property.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.weights" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">weights</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weights" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">weights</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Weights of the assets in the bucket. This is only available after weight allocation is done
by calling <code class="language-python highlight"><span class="n">Bucket</span><span class="o">.</span><span class="n">weight_</span><span class="o">*</span><span class="p">()</span></code> methods. This is a read-only property.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.append" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">append</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.append" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">append</span><span class="p">(</span><span class="n">ranked_list</span><span class="p">:</span> <span class="n">list</span> <span class="o">|</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="o">*</span><span class="n">conditions</span><span class="p">:</span> <span class="n">list</span> <span class="o">|</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation.Bucket" href="#minitrade.backtest.core.backtesting.Allocation.Bucket">Bucket</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add assets that are in the ranked list to the end of the bucket.</p>
<p><code class="language-python highlight"><span class="n">ranked_list</span></code> can be specified in three ways:</p>
<ol>
<li>A list of assets or anything list-like, all items will be added.</li>
<li>A boolean Series with assets as the index and a True value to indicate the asset should be added.</li>
<li>A non-boolean Series with assets as the index and all assets in the index will be added.</li>
</ol>
<p>The rank of the assets is determined by its order in the list or in the index. The rank of the assets 
in the bucket is preserved. If an asset is already in the bucket, its rank in bucket will not be affected
by appending new list to the bucket, even if the asset is ranked differently in the new list.</p>
<p>Multiple conditions can be specified as filters to exclude certain assets in the ranked list from being 
added. Assets must satisfy all the conditions in order to be added to the bucket.</p>
<p><code class="language-python highlight"><span class="n">conditions</span></code> can be specified in the same way as <code class="language-python highlight"><span class="n">ranked_list</span></code>, only that the asset order in a condition
is not important.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Append &#39;A&#39; and &#39;B&#39; to the bucket</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Append &#39;A&#39; and &#39;C&#39; to the bucket</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Append &#39;C&#39; to the bucket</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>ranked_list</code></td>
            <td>
                  <code>list | <span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of assets or a Series of assets to be added to the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>conditions</code></td>
            <td>
                  <code>list | <span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of assets or a Series of assets to be used as conditions to filter the assets.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.apply" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">apply</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.apply" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">apply</span><span class="p">(</span><span class="n">method</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;update&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation.Bucket" href="#minitrade.backtest.core.backtesting.Allocation.Bucket">Bucket</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply the weight allocation to the parent allocation object.</p>
<p><code class="language-python highlight"><span class="n">method</span></code> controls how the bucket weight allocation should be merged into the parent allocation object.</p>
<p>When <code class="language-python highlight"><span class="n">method</span></code> is <code class="language-python highlight"><span class="n">update</span></code>, the weights of assets in the bucket will update the weights of the same assets
in the parent allocation object. If an asset is not in the bucket, its weight in the parent allocation object 
will not be changed. This is the default method.</p>
<p>When <code class="language-python highlight"><span class="n">method</span></code> is <code class="language-python highlight"><span class="n">overwrite</span></code>, the weights of the parent allocation object will be replaced by the weights of the 
assets in the bucket or set to 0 if the asset is not in the bucket.</p>
<p>When <code class="language-python highlight"><span class="n">method</span></code> is <code class="language-python highlight"><span class="n">accumulate</span></code>, the weights of the assets in the bucket will be added to the weights of the same 
assets, while the weights of the assets not in the bucket will remain unchanged.</p>
<p>If the bucket is empty, no change will be made to the parent allocation object.</p>
<p>Note that no validation is performed on the weights of the parent allocation object after the bucket weight
is merged. It is the responsibility of the user to ensure the final weights are valid before use.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>method</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method to merge the bucket into the parent allocation object. 
Available methods are 'update', 'overwrite', 'accumulate'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;update&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.remove" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">remove</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.remove" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">remove</span><span class="p">(</span><span class="o">*</span><span class="n">conditions</span><span class="p">:</span> <span class="n">list</span> <span class="o">|</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation.Bucket" href="#minitrade.backtest.core.backtesting.Allocation.Bucket">Bucket</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Remove assets that satisify all the given conditions from the bucket.</p>
<p><code class="language-python highlight"><span class="n">conditions</span></code> can be specified in three ways:</p>
<ol>
<li>A list of assets or anything list-like, all assets will be removed.</li>
<li>A boolean Series with assets as the index and a True value to indicate the asset should be removed.</li>
<li>A non-boolean Series with assets as the index and all assets in the index will be removed.</li>
</ol>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Remove &#39;A&#39; and &#39;B&#39; from the bucket</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">bucket</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Remove &#39;A&#39; and &#39;C&#39; from the bucket</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">bucket</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Remove &#39;A&#39; and &#39;B&#39; from the bucket</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">bucket</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># Remove &#39;B&#39; from the bucket</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">bucket</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div>
Args:
    conditions: A list of assets or a Series of assets to be used as conditions to filter the assets.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.trim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">trim</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.trim" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">trim</span><span class="p">(</span><span class="n">limit</span><span class="p">:</span> <span class="n">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation.Bucket" href="#minitrade.backtest.core.backtesting.Allocation.Bucket">Bucket</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Trim the bucket to a maximum number of assets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>limit</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of assets should be included</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.weight_equally" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">weight_equally</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_equally" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">weight_equally</span><span class="p">(</span><span class="n">sum_</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation.Bucket" href="#minitrade.backtest.core.backtesting.Allocation.Bucket">Bucket</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Allocate equity value equally to the assets in the bucket.</p>
<p><code class="language-python highlight"><span class="n">sum_</span></code> should be between 0 and 1, with 1 means 100% of value should be allocated.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weight_equally</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sum_</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total weight that should be allocated.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.weight_explicitly" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">weight_explicitly</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_explicitly" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">weight_explicitly</span><span class="p">(</span><span class="n">weight</span><span class="p">:</span> <span class="n">float</span> <span class="o">|</span> <span class="n">list</span> <span class="o">|</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation.Bucket" href="#minitrade.backtest.core.backtesting.Allocation.Bucket">Bucket</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Assign weights to the assets in the bucket.</p>
<p><code class="language-python highlight"><span class="n">weight</span></code> can be specified in three ways:</p>
<ol>
<li>A single weight should be assigned to all assets in the bucket.</li>
<li>A list of weights should be assigned to the assets in the bucket in rank order. If more weights are provided than the number of assets in the bucket, the extra weights are ignored. If fewer weights are provided, the remaining assets will be assigned a weight of 0.</li>
<li>A Series with assets as the index and the weight as the value. If no weight is provided for an asset, it will be assigned a weight of 0. If a weight is provided for an asset that is not in the bucket, it will be ignored.</li>
</ol>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weight_explicitly</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weight_explicitly</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weight_explicitly</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]))</span>
</code></pre></div>
Args:
    weight: A single value, a list of values or a Series of weights.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="minitrade.backtest.core.backtesting.Allocation.Bucket.weight_proportionally" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">weight_proportionally</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.Bucket.weight_proportionally" class="headerlink" title="Permanent link">¤</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">weight_proportionally</span><span class="p">(</span><span class="n">relative_weights</span><span class="p">:</span> <span class="n">list</span><span class="p">,</span> <span class="n">sum_</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation.Bucket" href="#minitrade.backtest.core.backtesting.Allocation.Bucket">Bucket</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Allocate equity value proportionally to the assets in the bucket.</p>
<p><code class="language-python highlight"><span class="n">sum_</span></code> should be between 0 and 1, with 1 means 100% of value should be allocated.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">bucket</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weight_proportionally</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>relative_weights</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of relative weights. The length of the list should be the same as the number of assets in the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sum_</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total weight that should be allocated.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Allocation.assume_previous" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">assume_previous</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.assume_previous" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">assume_previous</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Assume all assets inherit the same weight as used in the previous rebalance cycle.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Allocation.assume_zero" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">assume_zero</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.assume_zero" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">assume_zero</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Assume all assets have zero weight to begin with in a new rebalance cycle.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Allocation.normalize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">normalize</span>


<a href="#minitrade.backtest.core.backtesting.Allocation.normalize" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">normalize</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Normalize the weight allocation so that the sum of weights equals 1.</p>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="minitrade.backtest.core.backtesting.Backtest" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Backtest</span>


<a href="#minitrade.backtest.core.backtesting.Backtest" class="headerlink" title="Permanent link">¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Backtest</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="n"><span title="typing.Type">Type</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Strategy" href="#minitrade.backtest.core.backtesting.Strategy">Strategy</a></span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">cash</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">holding</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">commission</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">margin</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">trade_on_close</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hedging</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">exclusive_orders</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trade_start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lot_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fail_fast</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">storage</span><span class="p">:</span> <span class="n">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Backtest a particular (parameterized) strategy
on particular data.</p>
<p>Upon initialization, call method
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="n">run</span></code> to run a backtest
instance, or <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="n">optimize</span></code> to
optimize it.</p>

        <p><code class="language-python highlight"><span class="n">data</span></code> is a <code class="language-python highlight"><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></code> with 2-level columns:
1st level is a list of tickers, and 
2nd level is <code class="language-python highlight"><span class="n">Open</span></code>, <code class="language-python highlight"><span class="n">High</span></code>, <code class="language-python highlight"><span class="n">Low</span></code>, <code class="language-python highlight"><span class="n">Close</span></code>, and <code class="language-python highlight"><span class="n">Volume</span></code>.
If the strategy works only on one asset, the 1st level can be dropped.
If any columns are missing, set them to what you have available,
e.g.</p>
<div class="language-text highlight"><pre><span></span><code>df[&#39;Open&#39;] = df[&#39;High&#39;] = df[&#39;Low&#39;] = df[&#39;Close&#39;]
df[&#39;Volumn&#39;] = 0
</code></pre></div>
<p>The passed data frame can contain additional columns that
can be used by the strategy (e.g. sentiment info).
DataFrame index can be either a datetime index (timestamps)
or a monotonic range index (i.e. a sequence of periods).</p>
<p><code class="language-python highlight"><span class="n">strategy</span></code> is a <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span></code>
<em>subclass</em> (not an instance).</p>
<p><code class="language-python highlight"><span class="n">cash</span></code> is the initial cash to start with.</p>
<p><code class="language-python highlight"><span class="n">holding</span></code> is a mapping of preexisting assets and their sizes before 
backtest begins, e.g. </p>
<div class="language-text highlight"><pre><span></span><code>{&#39;AAPL&#39;: 10, &#39;MSFT&#39;: 5}
</code></pre></div>
<p><code class="language-python highlight"><span class="n">commission</span></code> is the commission ratio. E.g. if your broker's commission
is 1% of trade value, set commission to <code class="language-python highlight"><span class="mf">0.01</span></code>. Note, if you wish to
account for bid-ask spread, you can approximate doing so by increasing
the commission, e.g. set it to <code class="language-python highlight"><span class="mf">0.0002</span></code> for commission-less forex
trading where the average spread is roughly 0.2‰ of asking price.</p>
<p><code class="language-python highlight"><span class="n">margin</span></code> is the required margin (ratio) of a leveraged account.
No difference is made between initial and maintenance margins.
To run the backtest using e.g. 50:1 leverge that your broker allows,
set margin to <code class="language-python highlight"><span class="mf">0.02</span></code> (1 / leverage).</p>
<p>If <code class="language-python highlight"><span class="n">trade_on_close</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, market orders will be filled
with respect to the current bar's closing price instead of the
next bar's open.</p>
<p>If <code class="language-python highlight"><span class="n">hedging</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, allow trades in both directions simultaneously.
If <code class="language-python highlight"><span class="kc">False</span></code>, the opposite-facing orders first close existing trades in
a <a href="https://www.investopedia.com/terms/n/nfa-compliance-rule-2-43b.asp">FIFO</a> manner.</p>
<p>If <code class="language-python highlight"><span class="n">exclusive_orders</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, each new order auto-closes the previous
trade/position, making at most a single trade (long or short) in effect
at each time.</p>
<p>If <code class="language-python highlight"><span class="n">trade_start_date</span></code> is not None, orders generated before the date are
surpressed and ignored in backtesting.</p>
<p><code class="language-python highlight"><span class="n">lot_size</span></code> is the minimum increment of shares you buy in one order. Order 
size will be rounded to integer multiples during rebalance.</p>
<p><code class="language-python highlight"><span class="n">fail_fast</span></code>, when True, instructs the backtester to bail out when
cash is not enough to cover an order. This can be used in live trading
to detect issues early. If False, backtesting will ignore the order and 
continue, which can be convenient during algorithm research.</p>
<p><code class="language-python highlight"><span class="n">storage</span></code>, when not None, is a dictionary that contains saved states from 
past runs. Modification to storage is persisted and can be made available 
for future runs. </p>




  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Backtest.optimize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">optimize</span>


<a href="#minitrade.backtest.core.backtesting.Backtest.optimize" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">optimize</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">maximize</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="pandas.Series">Series</span></span><span class="p">],</span> <span class="n">float</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;SQN&#39;</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="n">max_tries</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n">int</span><span class="p">,</span> <span class="n">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">constraint</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n">dict</span><span class="p">],</span> <span class="n">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_heatmap</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_optimization</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n"><span title="typing.Tuple">Tuple</span></span><span class="p">[</span><span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">],</span> <span class="n"><span title="typing.Tuple">Tuple</span></span><span class="p">[</span><span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n">dict</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optimize strategy parameters to an optimal combination.
Returns result <code class="language-python highlight"><span class="n">pd</span><span class="o">.</span><span class="n">Series</span></code> of the best run.</p>
<p><code class="language-python highlight"><span class="n">maximize</span></code> is a string key from the
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="n">run</span></code>-returned results series,
or a function that accepts this series object and returns a number;
the higher the better. By default, the method maximizes
Van Tharp's <a href="https://google.com/search?q=System+Quality+Number">System Quality Number</a>.</p>
<p><code class="language-python highlight"><span class="n">method</span></code> is the optimization method. Currently two methods are supported:</p>
<ul>
<li><code class="language-python highlight"><span class="s2">&quot;grid&quot;</span></code> which does an exhaustive (or randomized) search over the
  cartesian product of parameter combinations, and</li>
<li><code class="language-python highlight"><span class="s2">&quot;skopt&quot;</span></code> which finds close-to-optimal strategy parameters using
  <a href="https://scikit-optimize.github.io/stable/auto_examples/bayesian-optimization.html">model-based optimization</a>, making at most <code class="language-python highlight"><span class="n">max_tries</span></code> evaluations.</li>
</ul>
<p><code class="language-python highlight"><span class="n">max_tries</span></code> is the maximal number of strategy runs to perform.
If <code class="language-python highlight"><span class="n">method</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span></code>, this results in randomized grid search.
If <code class="language-python highlight"><span class="n">max_tries</span></code> is a floating value between (0, 1], this sets the
number of runs to approximately that fraction of full grid space.
Alternatively, if integer, it denotes the absolute maximum number
of evaluations. If unspecified (default), grid search is exhaustive,
whereas for <code class="language-python highlight"><span class="n">method</span><span class="o">=</span><span class="s2">&quot;skopt&quot;</span></code>, <code class="language-python highlight"><span class="n">max_tries</span></code> is set to 200.</p>
<p><code class="language-python highlight"><span class="n">constraint</span></code> is a function that accepts a dict-like object of
parameters (with values) and returns <code class="language-python highlight"><span class="kc">True</span></code> when the combination
is admissible to test with. By default, any parameters combination
is considered admissible.</p>
<p>If <code class="language-python highlight"><span class="n">return_heatmap</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, besides returning the result
series, an additional <code class="language-python highlight"><span class="n">pd</span><span class="o">.</span><span class="n">Series</span></code> is returned with a multiindex
of all admissible parameter combinations, which can be further
inspected or projected onto 2D to plot a heatmap
(see <code class="language-python highlight"><span class="n">backtesting</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">plot_heatmaps</span><span class="p">()</span></code>).</p>
<p>If <code class="language-python highlight"><span class="n">return_optimization</span></code> is True and <code class="language-python highlight"><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;skopt&#39;</span></code>,
in addition to result series (and maybe heatmap), return raw
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.OptimizeResult.html"><code class="language-python highlight"><span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">OptimizeResult</span></code></a> for further
inspection, e.g. with <a href="https://scikit-optimize.github.io">scikit-optimize</a>        <a href="https://scikit-optimize.github.io/stable/modules/plots.html">plotting tools</a>.</p>
<p>If you want reproducible optimization results, set <code class="language-python highlight"><span class="n">random_state</span></code>
to a fixed integer random seed.</p>
<p>Additional keyword arguments represent strategy arguments with
list-like collections of possible values. For example, the following
code finds and returns the "best" of the 7 admissible (of the
9 possible) parameter combinations:</p>
<div class="language-text highlight"><pre><span></span><code>backtest.optimize(sma1=[5, 10, 15], sma2=[10, 20, 40],
                  constraint=lambda p: p.sma1 &lt; p.sma2)
</code></pre></div>
<p>.. TODO::
    Improve multiprocessing/parallel execution on Windos with start method 'spawn'.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Backtest.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#minitrade.backtest.core.backtesting.Backtest.plot" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">plot</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_equity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_return</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_pl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_volume</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_drawdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_trades</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">smooth_equity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">relative_equity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">superimpose</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n">bool</span><span class="p">,</span> <span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reverse_indicators</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">open_browser</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_allocation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">relative_allocation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot the progression of the last backtest run.</p>
<p>If <code class="language-python highlight"><span class="n">results</span></code> is provided, it should be a particular result
<code class="language-python highlight"><span class="n">pd</span><span class="o">.</span><span class="n">Series</span></code> such as returned by
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="n">run</span></code> or
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="n">optimize</span></code>, otherwise the last
run's results are used.</p>
<p><code class="language-python highlight"><span class="n">filename</span></code> is the path to save the interactive HTML plot to.
By default, a strategy/parameter-dependent file is created in the
current working directory.</p>
<p><code class="language-python highlight"><span class="n">plot_width</span></code> is the width of the plot in pixels. If None (default),
the plot is made to span 100% of browser width. The height is
currently non-adjustable.</p>
<p>If <code class="language-python highlight"><span class="n">plot_equity</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting plot will contain
an equity (initial cash plus assets) graph section. This is the same
as <code class="language-python highlight"><span class="n">plot_return</span></code> plus initial 100%.</p>
<p>If <code class="language-python highlight"><span class="n">plot_return</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting plot will contain
a cumulative return graph section. This is the same
as <code class="language-python highlight"><span class="n">plot_equity</span></code> minus initial 100%.</p>
<p>If <code class="language-python highlight"><span class="n">plot_pl</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting plot will contain
a profit/loss (P/L) indicator section.</p>
<p>If <code class="language-python highlight"><span class="n">plot_volume</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting plot will contain
a trade volume section.</p>
<p>If <code class="language-python highlight"><span class="n">plot_drawdown</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting plot will contain
a separate drawdown graph section.</p>
<p>If <code class="language-python highlight"><span class="n">plot_trades</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the stretches between trade entries
and trade exits are marked by hash-marked tractor beams.</p>
<p>If <code class="language-python highlight"><span class="n">smooth_equity</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the equity graph will be
interpolated between fixed points at trade closing times,
unaffected by any interim asset volatility.</p>
<p>If <code class="language-python highlight"><span class="n">relative_equity</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, scale and label equity graph axis
with return percent, not absolute cash-equivalent values.</p>
<p>If <code class="language-python highlight"><span class="n">superimpose</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, superimpose larger-timeframe candlesticks
over the original candlestick chart. Default downsampling rule is:
monthly for daily data, daily for hourly data, hourly for minute data,
and minute for (sub-)second data.
<code class="language-python highlight"><span class="n">superimpose</span></code> can also be a valid <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects">Pandas offset string</a>,
such as <code class="language-python highlight"><span class="s1">&#39;5T&#39;</span></code> or <code class="language-python highlight"><span class="s1">&#39;5min&#39;</span></code>, in which case this frequency will be
used to superimpose.
Note, this only works for data with a datetime index.</p>
<p>If <code class="language-python highlight"><span class="n">resample</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the OHLC data is resampled in a way that
makes the upper number of candles for Bokeh to plot limited to 10_000.
This may, in situations of overabundant data,
improve plot's interactive performance and avoid browser's
<code class="language-python highlight"><span class="n">Javascript</span> <span class="n">Error</span><span class="p">:</span> <span class="n">Maximum</span> <span class="n">call</span> <span class="n">stack</span> <span class="n">size</span> <span class="n">exceeded</span></code> or similar.
Equity &amp; dropdown curves and individual trades data is,
<code class="language-python highlight"><span class="n">resample</span></code> can also be a <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects">Pandas offset string</a>,
such as <code class="language-python highlight"><span class="s1">&#39;5T&#39;</span></code> or <code class="language-python highlight"><span class="s1">&#39;5min&#39;</span></code>, in which case this frequency will be
used to resample, overriding above numeric limitation.
Note, all this only works for data with a datetime index.</p>
<p>If <code class="language-python highlight"><span class="n">reverse_indicators</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the indicators below the OHLC chart
are plotted in reverse order of declaration.</p>
<p>If <code class="language-python highlight"><span class="n">show_legend</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting plot graphs will contain
labeled legends.</p>
<p>If <code class="language-python highlight"><span class="n">open_browser</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting <code class="language-python highlight"><span class="n">filename</span></code> will be
opened in the default web browser.</p>
<p>If <code class="language-python highlight"><span class="n">plot_allocation</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting plot will contain
an equity allocation graph section. </p>
<p>If <code class="language-python highlight"><span class="n">relative_allocation</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, scale and label equity allocation graph axis
with return percent, not absolute cash-equivalent values.</p>
<p>If <code class="language-python highlight"><span class="n">plot_indicator</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the resulting plot will contain
a section for each indicator used in the strategy.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Backtest.run" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">run</span>


<a href="#minitrade.backtest.core.backtesting.Backtest.run" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas.Series">Series</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Run the backtest. Returns <code class="language-python highlight"><span class="n">pd</span><span class="o">.</span><span class="n">Series</span></code> with results and statistics.</p>
<p>Keyword arguments are interpreted as strategy parameters.</p>
<div class="language-text highlight"><pre><span></span><code>&gt;&gt;&gt; Backtest(GOOG, SmaCross).run()
Start                     2004-08-19 00:00:00
End                       2013-03-01 00:00:00
Duration                   3116 days 00:00:00
Exposure Time [%]                     93.9944
Equity Final [$]                      51959.9
Equity Peak [$]                       75787.4
Return [%]                            419.599
Buy &amp; Hold Return [%]                 703.458
Return (Ann.) [%]                      21.328
Volatility (Ann.) [%]                 36.5383
Sharpe Ratio                         0.583718
Sortino Ratio                         1.09239
Calmar Ratio                         0.444518
Max. Drawdown [%]                    -47.9801
Avg. Drawdown [%]                    -5.92585
Max. Drawdown Duration      584 days 00:00:00
Avg. Drawdown Duration       41 days 00:00:00
# Trades                                   65
Win Rate [%]                          46.1538
Best Trade [%]                         53.596
Worst Trade [%]                      -18.3989
Avg. Trade [%]                        2.35371
Max. Trade Duration         183 days 00:00:00
Avg. Trade Duration          46 days 00:00:00
Profit Factor                         2.08802
Expectancy [%]                        8.79171
SQN                                  0.916893
Kelly Criterion                        0.6134
_strategy                            SmaCross
_equity_curve                           Eq...
_trades                       Size  EntryB...
_orders                              Ticke...
_positions                           {&#39;GOO...
_trade_start_bar                           0
dtype: object
</code></pre></div>
<p>.. warning::
    You may obtain different results for different strategy parameters.
    E.g. if you use 50- and 200-bar SMA, the trading simulation will
    begin on bar 201. The actual length of delay is equal to the lookback
    period of the <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">I</span></code> indicator which lags the most.
    Obviously, this can affect results.</p>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="minitrade.backtest.core.backtesting.Order" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Order</span>


<a href="#minitrade.backtest.core.backtesting.Order" class="headerlink" title="Permanent link">¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Order</span><span class="p">(</span><span class="n">broker</span><span class="p">:</span> <span class="n"><span title="minitrade.backtest.core.backtesting._Broker">_Broker</span></span><span class="p">,</span> <span class="n">ticker</span><span class="p">:</span> <span class="n">str</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">float</span><span class="p">,</span> <span class="n">limit_price</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop_price</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sl_price</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tp_price</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parent_trade</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Trade" href="#minitrade.backtest.core.backtesting.Trade">Trade</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entry_time</span><span class="p">:</span> <span class="n"><span title="datetime.datetime">datetime</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Place new orders through <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">buy</span><span class="p">()</span></code> and <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">sell</span><span class="p">()</span></code>.
Query existing orders through <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">orders</span></code>.</p>
<p>When an order is executed or <a href="https://www.investopedia.com/terms/f/fill.asp">filled</a>, it results in a <code class="language-python highlight"><span class="n">Trade</span></code>.</p>
<p>If you wish to modify aspects of a placed but not yet filled order,
cancel it and place a new one instead.</p>
<p>All placed orders are <a href="https://www.investopedia.com/terms/g/gtc.asp">Good 'Til Canceled</a>.</p>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.entry_time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">entry_time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.entry_time" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">entry_time</span><span class="p">:</span> <span class="n"><span title="datetime.datetime">datetime</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Time of when the order is created.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.is_contingent" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_contingent</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.is_contingent" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_contingent</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>True for <a href="https://www.investopedia.com/terms/c/contingentorder.asp">contingent</a> orders, i.e. <a href="https://www.investopedia.com/terms/o/oco.asp">OCO</a> stop-loss and take-profit bracket orders
placed upon an active trade. Remaining contingent orders are canceled when
their parent <code class="language-python highlight"><span class="n">Trade</span></code> is closed.</p>
<p>You can modify contingent orders through <code class="language-python highlight"><span class="n">Trade</span><span class="o">.</span><span class="n">sl</span></code> and <code class="language-python highlight"><span class="n">Trade</span><span class="o">.</span><span class="n">tp</span></code>.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.is_long" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_long</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.is_long" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_long</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>True if the order is long (order size is positive).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.is_short" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_short</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.is_short" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_short</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>True if the order is short (order size is negative).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.limit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">limit</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.limit" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">limit</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Order limit price for <a href="https://www.investopedia.com/terms/l/limitorder.asp">limit orders</a>, or None for <a href="https://www.investopedia.com/terms/m/marketorder.asp">market orders</a>,
which are filled at next available price.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.size" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.size" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">size</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Order size (negative for short orders).</p>
<p>If size is a value between 0 and 1, it is interpreted as a fraction of current
available liquidity (cash plus <code class="language-python highlight"><span class="n">Position</span><span class="o">.</span><span class="n">pl</span></code> minus used margin).
A value greater than or equal to 1 indicates an absolute number of units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.sl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sl</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.sl" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sl</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A stop-loss price at which, if set, a new contingent stop-market order
will be placed upon the <code class="language-python highlight"><span class="n">Trade</span></code> following this order's execution.
See also <code class="language-python highlight"><span class="n">Trade</span><span class="o">.</span><span class="n">sl</span></code>.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.stop" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">stop</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.stop" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">stop</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Order stop price for <a href="https://www.investopedia.com/terms/s/stoporder.asp">stop-limit/stop-market</a> order,
otherwise None if no stop was set, or the stop price has already been hit.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.tag" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tag</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.tag" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tag</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Arbitrary value (such as a string) which, if set, enables tracking
of this order and the associated <code class="language-python highlight"><span class="n">Trade</span></code> (see <code class="language-python highlight"><span class="n">Trade</span><span class="o">.</span><span class="n">tag</span></code>).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Order.tp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tp</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Order.tp" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tp</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A take-profit price at which, if set, a new contingent limit order
will be placed upon the <code class="language-python highlight"><span class="n">Trade</span></code> following this order's execution.
See also <code class="language-python highlight"><span class="n">Trade</span><span class="o">.</span><span class="n">tp</span></code>.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Order.cancel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">cancel</span>


<a href="#minitrade.backtest.core.backtesting.Order.cancel" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">cancel</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Cancel the order.</p>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="minitrade.backtest.core.backtesting.Position" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Position</span>


<a href="#minitrade.backtest.core.backtesting.Position" class="headerlink" title="Permanent link">¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Position</span><span class="p">(</span><span class="n">broker</span><span class="p">:</span> <span class="n"><span title="minitrade.backtest.core.backtesting._Broker">_Broker</span></span><span class="p">,</span> <span class="n">ticker</span><span class="p">:</span> <span class="n">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Currently held asset position, available as
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">position</span></code> within
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">next</span></code>.
Can be used in boolean contexts, e.g.</p>
<div class="language-text highlight"><pre><span></span><code>if self.position():
    ...  # we have a position, either long or short
</code></pre></div>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Position.is_long" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_long</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Position.is_long" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_long</span><span class="p">:</span> <span class="n">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>True if the position is long (position size is positive).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Position.is_short" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_short</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Position.is_short" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_short</span><span class="p">:</span> <span class="n">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>True if the position is short (position size is negative).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Position.pl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pl</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Position.pl" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">pl</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Profit (positive) or loss (negative) of the current position in cash units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Position.pl_pct" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pl_pct</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Position.pl_pct" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">pl_pct</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Profit (positive) or loss (negative) of the current position in percent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Position.size" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Position.size" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">size</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Position size in units of asset. Negative if position is short.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Position.close" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">close</span>


<a href="#minitrade.backtest.core.backtesting.Position.close" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">close</span><span class="p">(</span><span class="n">portion</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Close portion of position by closing <code class="language-python highlight"><span class="n">portion</span></code> of each active trade. See <code class="language-python highlight"><span class="n">Trade</span><span class="o">.</span><span class="n">close</span></code>.</p>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="minitrade.backtest.core.backtesting.Strategy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Strategy</span>


<a href="#minitrade.backtest.core.backtesting.Strategy" class="headerlink" title="Permanent link">¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Strategy</span><span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>A trading strategy base class. Extend this class and
override methods
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">init</span></code> and
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">next</span></code> to define
your own strategy.</p>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Strategy.alloc" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">alloc</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.alloc" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">alloc</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Allocation" href="#minitrade.backtest.core.backtesting.Allocation">Allocation</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p><code class="language-python highlight"><span class="n">Allocation</span></code> instance that manages the weight allocation among assets.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Strategy.closed_trades" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">closed_trades</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.closed_trades" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">closed_trades</span><span class="p">:</span> <span class="n"><span title="typing.Tuple">Tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Trade" href="#minitrade.backtest.core.backtesting.Trade">Trade</a></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List of settled trades (see <code class="language-python highlight"><span class="n">Trade</span></code>).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Strategy.data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">data</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.data" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">data</span><span class="p">:</span> <span class="n"><span title="minitrade.backtest.core._util._Data">_Data</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Price data, roughly as passed into
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="fm">__init__</span></code>,
but with two significant exceptions:</p>
<ul>
<li><code class="language-python highlight"><span class="n">data</span></code> is <em>not</em> a DataFrame, but a custom structure
  that serves customized numpy arrays for reasons of performance
  and convenience. Besides OHLCV columns, <code class="language-python highlight"><span class="o">.</span><span class="n">index</span></code> and length,
  it offers <code class="language-python highlight"><span class="o">.</span><span class="n">pip</span></code> property, the smallest price unit of change.</li>
<li>Within <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">init</span></code>, <code class="language-python highlight"><span class="n">data</span></code> arrays
  are available in full length, as passed into
  <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="fm">__init__</span></code>
  (for precomputing indicators and such). However, within
  <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">next</span></code>, <code class="language-python highlight"><span class="n">data</span></code> arrays are
  only as long as the current iteration, simulating gradual
  price point revelation. In each call of
  <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">next</span></code> (iteratively called by
  <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span></code> internally),
  the last array value (e.g. <code class="language-python highlight"><span class="n">data</span><span class="o">.</span><span class="n">Close</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></code>)
  is always the <em>most recent</em> value.</li>
<li>If you need data arrays (e.g. <code class="language-python highlight"><span class="n">data</span><span class="o">.</span><span class="n">Close</span></code>) to be indexed
  <strong>Pandas Series or DataFrame</strong>, you can call their <code class="language-python highlight"><span class="o">.</span><span class="n">df</span></code> accessor
  (e.g. <code class="language-python highlight"><span class="n">data</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">df</span></code>). If you need the whole of data
  as a <strong>DataFrame</strong>, use <code class="language-python highlight"><span class="o">.</span><span class="n">df</span></code> accessor (i.e. <code class="language-python highlight"><span class="n">data</span><span class="o">.</span><span class="n">df</span></code>).</li>
</ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Strategy.equity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">equity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.equity" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">equity</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Current account equity (cash plus assets).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Strategy.orders" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">orders</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.orders" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">orders</span><span class="p">:</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Order" href="#minitrade.backtest.core.backtesting.Order">Order</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List of orders (see <code class="language-python highlight"><span class="n">Order</span></code>) waiting for execution.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Strategy.storage" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">storage</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.storage" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">storage</span><span class="p">:</span> <span class="n">dict</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Storage is a dictionary for saving custom data across backtest runs
when used in the context of automated trading in incremental mode. </p>
<p>If backtest finishes successfully, any modification to the dictionary 
is persisted and can be accessed in future runs. If backtest fails due 
to any error, the modification is not saved. If backtest runs in dryrun 
mode, the modification is not saved.</p>
<p>No storage is provided when trading in "strict" mode, in which case <code class="language-python highlight"><span class="n">storage</span></code> 
is None.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.I" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">I</span>


<a href="#minitrade.backtest.core.backtesting.Strategy.I" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">I</span><span class="p">(</span><span class="n">funcval</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Declare an indicator. An indicator is just an array of values,
but one that is revealed gradually in
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">next</span></code> much like
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">data</span></code> is.
Returns DataFrame in <code class="language-python highlight"><span class="n">init</span><span class="p">()</span></code> and <code class="language-python highlight"><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code> of indicator values in <code class="language-python highlight"><span class="nb">next</span><span class="p">()</span></code>.</p>
<p><code class="language-python highlight"><span class="n">funcval</span></code> is either a function that returns the indicator array(s) of
same length as <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">data</span></code>, or
the indicator array(s) itself as a DataFrame, Series, or arrays.</p>
<p>In the plot legend, the indicator is labeled with function name, 
DataFrame column name, or Series name, unless <code class="language-python highlight"><span class="n">name</span></code> overrides it.</p>
<p>If <code class="language-python highlight"><span class="n">plot</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the indicator is plotted on the resulting
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="n">plot</span></code>.</p>
<p>If <code class="language-python highlight"><span class="n">overlay</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the indicator is plotted overlaying the
price candlestick chart (suitable e.g. for moving averages).
If <code class="language-python highlight"><span class="kc">False</span></code>, the indicator is plotted standalone below the
candlestick chart. </p>
<p><code class="language-python highlight"><span class="n">color</span></code> can be string hex RGB triplet or X11 color name.
By default, the next available color is assigned.</p>
<p>If <code class="language-python highlight"><span class="n">scatter</span></code> is <code class="language-python highlight"><span class="kc">True</span></code>, the plotted indicator marker will be a
circle instead of a connected line segment (default).</p>
<p>Additional <code class="language-python highlight"><span class="o">*</span><span class="n">args</span></code> and <code class="language-python highlight"><span class="o">**</span><span class="n">kwargs</span></code> are passed to <code class="language-python highlight"><span class="n">func</span></code> and can
be used for parameters.</p>
<p>For example, using simple moving average function from TA-Lib:</p>
<div class="language-text highlight"><pre><span></span><code>def init():
    self.sma = self.I(ta.SMA, self.data.Close, self.n_sma)
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.buy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">buy</span>


<a href="#minitrade.backtest.core.backtesting.Strategy.buy" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">buy</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">ticker</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="n">_FULL_EQUITY</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sl</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tp</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Place a new long order. For explanation of parameters, see <code class="language-python highlight"><span class="n">Order</span></code> and its properties.</p>
<p>For single asset strategy, <code class="language-python highlight"><span class="n">ticker</span></code> can be left as None.</p>
<p>See <code class="language-python highlight"><span class="n">Position</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></code> and <code class="language-python highlight"><span class="n">Trade</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></code> for closing existing positions.</p>
<p>See also <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">sell</span><span class="p">()</span></code>.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.init" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">init</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.init" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">init</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the strategy.
Override this method.
Declare indicators (with <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">I</span></code>).
Precompute what needs to be precomputed or can be precomputed
in a vectorized fashion before the strategy starts.</p>
<p>If you extend composable strategies from <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">lib</span></code>,
make sure to call: <code class="language-python highlight"><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">init</span><span class="p">()</span></code></p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.next" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">next</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.next" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">next</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Main strategy runtime method, called as each new
<code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">data</span></code>
instance (row; full candlestick bar) becomes available.
This is the main method where strategy decisions
upon data precomputed in <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Strategy</span><span class="o">.</span><span class="n">init</span></code>
take place.</p>
<p>If you extend composable strategies from <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">lib</span></code>,
make sure to call: <code class="language-python highlight"><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></code></p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.position" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">position</span>


<a href="#minitrade.backtest.core.backtesting.Strategy.position" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">position</span><span class="p">(</span><span class="n">ticker</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Position" href="#minitrade.backtest.core.backtesting.Position">Position</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Instance of <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Position</span></code>.</p>
<p>For single asset strategy, <code class="language-python highlight"><span class="n">ticker</span></code> can be left as None, which returns
the position of the only asset.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.prepare_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">prepare_data</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Strategy.prepare_data" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prepare_data</span><span class="p">(</span><span class="n">tickers</span><span class="p">:</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n">str</span><span class="p">],</span> <span class="n">start</span><span class="p">:</span> <span class="n">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prepare data for trading.</p>
<p>This class method can be overridden in a <code class="language-python highlight"><span class="n">Strategy</span></code> implementation to provide
data for trading. The can be useful when the data is not provided externally
and the strategy wants to bring its own data, e.g. from a database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>tickers</code></td>
            <td>
                  <code><span title="typing.List">List</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tickers to fetch data for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>start</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start date of the data to fetch.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code class="language-python highlight"><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></code> with 2-level columns as required by <code class="language-python highlight"><span class="n">Backtest</span><span class="p">()</span></code> or None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.rebalance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">rebalance</span>


<a href="#minitrade.backtest.core.backtesting.Strategy.rebalance" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">rebalance</span><span class="p">(</span><span class="n">force</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">rtol</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cash_reserve</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Rebalance the portfolio according to the current weight allocation.</p>
<p>If the weight allocation is not changed from the previous cycle, the rebalance is skipped. This behavior can be
overridden by setting <code class="language-python highlight"><span class="n">force</span></code> to <code class="language-python highlight"><span class="kc">True</span></code>, which will force rebalance even if the weight allocation is unchanged.
This is useful when the actual portfolio value deviates from the target value due to price changes and should 
be corrected.</p>
<p>When a rebalance should be performed, the difference between the target and actual portfolio, defined as the sum 
of absolute difference of individual assets, is calculated. If the difference is too small compared to the
relative tolerance <code class="language-python highlight"><span class="n">rtol</span></code> or the absolute tolerance <code class="language-python highlight"><span class="n">atol</span></code>, the rebalance is again skipped. This can be used
to avoid unnecessary transaction cost. An exception is when the target weight of an asset is zero, in which case 
the position of the asset, if exists, is always closed.</p>
<p><code class="language-python highlight"><span class="n">cash_reserve</span></code> is the ratio of total equity reserved as cash to account for order quantity rounding and sudden
price changes between order placement and execution. It is recommended to set this value to a small positive
number to avoid order rejection due to insufficient cash. The minimum value may depend on the volatility of the 
assets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>force</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, rebalance will be performed even if the current weight allocation
is not changed from the previous.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rtol</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative tolerance of the total absolute value difference between current 
and previous allocation vs. total portfolio value. If the difference is smaller 
than <code class="language-python highlight"><span class="n">rtol</span></code>, rebalance will not be performed.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>atol</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Absolute tolerance of the total absolute value difference between current 
and previous allocation. If the difference is smaller than <code class="language-python highlight"><span class="n">atol</span></code>, rebalance 
will not be performed.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>cash_reserve</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of total equity reserved as cash to account for order 
quantity rounding and sudden price changes between order placement and
execution.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.record" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">record</span>


<a href="#minitrade.backtest.core.backtesting.Strategy.record" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">record</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">overlay</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scatter</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Record arbitrary key-value pairs as time series. This can be used for diagnostic
data collection or for plotting custom data. </p>
<p>Values to be recorded should be passed as keyword arguments. The value can be a scalar, a dictionary, or a
pandas Series. If a dictionary or a Series is passed, its keys will be used as names for time series.</p>
<p>Example:
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Record a scalar value</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">my_key</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Record a dictionary</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">my_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Record a pandas Series</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">my_series</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}))</span>
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the time series. If not provided, the name will be the same as the keyword argument.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>plot</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the time series will be plotted on the resulting <code class="language-python highlight"><span class="n">minitrade</span><span class="o">.</span><span class="n">backtest</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">backtesting</span><span class="o">.</span><span class="n">Backtest</span><span class="o">.</span><span class="n">plot</span></code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>overlay</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the time series will be plotted overlaying the price candlestick chart. If False, the time series
will be plotted standalone below the candlestick chart.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>color</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the time series. If not provided, the next available color will be assigned.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>scatter</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the plotted time series marker will be a circle instead of a connected line segment.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.sell" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sell</span>


<a href="#minitrade.backtest.core.backtesting.Strategy.sell" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">sell</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">ticker</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="n">_FULL_EQUITY</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sl</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tp</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Place a new short order. For explanation of parameters, see <code class="language-python highlight"><span class="n">Order</span></code> and its properties.</p>
<p>For single asset strategy, <code class="language-python highlight"><span class="n">ticker</span></code> can be left as None.</p>
<p>See also <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">buy</span><span class="p">()</span></code>.</p>
<p>.. note::
    If you merely want to close an existing long position,
    use <code class="language-python highlight"><span class="n">Position</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></code> or <code class="language-python highlight"><span class="n">Trade</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></code>.</p>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.start_on_day" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">start_on_day</span>


<a href="#minitrade.backtest.core.backtesting.Strategy.start_on_day" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">start_on_day</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Hint to start the backtest on a specific day.</p>
<p>This can be used to define a warm-up period, ensuring at least <code class="language-python highlight"><span class="n">n</span></code> days of data 
are available when <code class="language-python highlight"><span class="nb">next</span><span class="p">()</span></code> is called for the first time. </p>
<p>When the backtest starts depends both on <code class="language-python highlight"><span class="n">n</span></code> and on the availability of indicators. 
If indicators are defined, the backtest will start when all indicators have 
valid data or on the <code class="language-python highlight"><span class="n">n</span></code>-th day, whichever comes later.</p>
<p>This method should be called in <code class="language-python highlight"><span class="n">init</span><span class="p">()</span></code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>n</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Day index to start on. Must be within [0, len(data)-1].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Strategy.trades" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">trades</span>


<a href="#minitrade.backtest.core.backtesting.Strategy.trades" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">trades</span><span class="p">(</span><span class="n">ticker</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Tuple">Tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="minitrade.backtest.core.backtesting.Trade" href="#minitrade.backtest.core.backtesting.Trade">Trade</a></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List of active trades (see <code class="language-python highlight"><span class="n">Trade</span></code>).</p>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="minitrade.backtest.core.backtesting.Trade" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Trade</span>


<a href="#minitrade.backtest.core.backtesting.Trade" class="headerlink" title="Permanent link">¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Trade</span><span class="p">(</span><span class="n">broker</span><span class="p">:</span> <span class="n"><span title="minitrade.backtest.core.backtesting._Broker">_Broker</span></span><span class="p">,</span> <span class="n">ticker</span><span class="p">:</span> <span class="n">str</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">int</span><span class="p">,</span> <span class="n">entry_price</span><span class="p">:</span> <span class="n">float</span><span class="p">,</span> <span class="n">entry_bar</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>When an <code class="language-python highlight"><span class="n">Order</span></code> is filled, it results in an active <code class="language-python highlight"><span class="n">Trade</span></code>.
Find active trades in <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">trades</span></code> and closed, settled trades in <code class="language-python highlight"><span class="n">Strategy</span><span class="o">.</span><span class="n">closed_trades</span></code>.</p>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.entry_bar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">entry_bar</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.entry_bar" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">entry_bar</span><span class="p">:</span> <span class="n">int</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Candlestick bar index of when the trade was entered.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.entry_price" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">entry_price</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.entry_price" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">entry_price</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Trade entry price.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.entry_time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">entry_time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.entry_time" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">entry_time</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="pandas.Timestamp">Timestamp</span></span><span class="p">,</span> <span class="n">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Datetime of when the trade was entered.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.exit_bar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">exit_bar</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.exit_bar" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">exit_bar</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Candlestick bar index of when the trade was exited
(or None if the trade is still active).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.exit_price" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">exit_price</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.exit_price" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">exit_price</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Trade exit price (or None if the trade is still active).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.exit_time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">exit_time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.exit_time" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">exit_time</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="pandas.Timestamp">Timestamp</span></span><span class="p">,</span> <span class="n">int</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Datetime of when the trade was exited.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.is_long" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_long</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.is_long" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_long</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>True if the trade is long (trade size is positive).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.is_short" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_short</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.is_short" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_short</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>True if the trade is short (trade size is negative).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.pl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pl</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.pl" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">pl</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Trade profit (positive) or loss (negative) in cash units.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.pl_pct" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pl_pct</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.pl_pct" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">pl_pct</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Trade profit (positive) or loss (negative) in percent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.size" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.size" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">size</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Trade size (volume; negative for short trades).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.sl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sl</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.sl" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sl</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Stop-loss price at which to close the trade.</p>
<p>This variable is writable. By assigning it a new price value,
you create or modify the existing SL order.
By assigning it <code class="language-python highlight"><span class="kc">None</span></code>, you cancel it.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.tag" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tag</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.tag" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tag</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A tag value inherited from the <code class="language-python highlight"><span class="n">Order</span></code> that opened
this trade.</p>
<p>This can be used to track trades and apply conditional
logic / subgroup analysis.</p>
<p>See also <code class="language-python highlight"><span class="n">Order</span><span class="o">.</span><span class="n">tag</span></code>.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.tp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tp</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.tp" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tp</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Take-profit price at which to close the trade.</p>
<p>This property is writable. By assigning it a new price value,
you create or modify the existing TP order.
By assigning it <code class="language-python highlight"><span class="kc">None</span></code>, you cancel it.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="minitrade.backtest.core.backtesting.Trade.value" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">value</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#minitrade.backtest.core.backtesting.Trade.value" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">value</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Trade total value in cash (volume × price).</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="minitrade.backtest.core.backtesting.Trade.close" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">close</span>


<a href="#minitrade.backtest.core.backtesting.Trade.close" class="headerlink" title="Permanent link">¤</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">close</span><span class="p">(</span><span class="n">portion</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Place new <code class="language-python highlight"><span class="n">Order</span></code> to close <code class="language-python highlight"><span class="n">portion</span></code> of the trade at next market price.</p>

    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Wei Wu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.indexes", "toc.follow", "navigation.top"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>